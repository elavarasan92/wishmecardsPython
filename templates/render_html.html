<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Authentication</title>
</head>

<body>
  <div>
    <button id="getVisitingCard">getVisitingCard</button>
    <button id="goodLogin">Good Login</button>
    <button id="badLogin">Bad Login</button>
    <button id="logout">Logout</button>
  </div>
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script type="text/javascript">
  var baseUrl = "http://localhost:3500/";
  $(document).ready(function() {
    $('#getVisitingCard').click(function() {
      $.ajax({
        type: 'GET',
        url: baseUrl+'visiting_cards',
        contentType: "application/json",
        beforeSend: function(xhr) {
          if (localStorage.token) {
            xhr.setRequestHeader('Authorization', 'Bearer ' + localStorage.token);
          }
        },
        success: function(data) {
        console.log(JSON.stringify(data));
        alert(JSON.stringify(data));
          alert('Hello ' + data + '! You have successfully accessed to /api/profile.');
        },
        error: function() {
          alert("Sorry, you are not logged in.");
        }
      });
    });
    $('#goodLogin').click(function() {
      $.ajax({
        type: "POST",
        url: baseUrl+"auth/login",
        contentType: "application/json",
        data: JSON.stringify({
          "email": "elavarasan_natarajan@yahoo.com",
          "password": "default"
        }),
        success: function(data) {
          console.log(data);
          localStorage.token = data.token;
          alert('Got a token from the server! Token: ' + data.token);
        },
        error: function() {
          alert("Login Failed");
        }
      });
    });
    $('#badLogin').click(function() {
      $.ajax({
        type: "POST",
        url: baseUrl+"auth/login",
        contentType: "application/json",
        data: JSON.stringify({
          "email": "elavarasan_natarajan@yahoo.com",
          "password": "default1"
        }),
        success: function(data) {
          alert("ERROR: it is not supposed to alert.");
        },
        error: function() {
          alert("Login Failed");
        }
      });
    });
    $('#logout').click(function() {
      localStorage.clear();
    });
  });
  </script>
</body>

</html>